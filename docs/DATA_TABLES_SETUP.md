# Database Tables & Mock Data Setup - Complete

## Overview
All admin data is now stored in Firestore collections with mock data that can be easily replaced with real data from your database.

---

## Collections Created

### 1. **notifications** Collection
Stores sent notifications and notification history.

**Fields:**
```typescript
{
  id: string;           // Auto-generated by Firestore
  title: string;
  message: string;
  type: 'info' | 'success' | 'offer' | 'warning';
  recipientType: 'all' | 'specific';
  recipientCount: number;
  sentAt: string;       // ISO timestamp
  actionUrl?: string;
  createdAt: Timestamp;
}
```

**Mock Data Included:**
- "50% Off Sale" - offer type, sent 1 day ago
- "New Event Added" - info type, sent 2 days ago
- "Welcome to Joy Juncture!" - success type, sent 3 days ago

---

### 2. **campaigns** Collection
Stores push notification campaigns with analytics.

**Fields:**
```typescript
{
  id: string;              // Auto-generated by Firestore
  title: string;
  message: string;
  status: 'sent' | 'scheduled' | 'draft';
  recipientCount: number;
  deliveredCount: number;
  interactionCount: number;
  createdAt: string;       // ISO timestamp
  image?: string;
  actionUrl?: string;
  priority?: 'low' | 'normal' | 'high';
}
```

**Mock Data Included:**
- "Flash Sale Alert" - 60% off campaign, 1150 delivered, 340 interactions
- "New Collection Launch" - new games announcement, 1200 delivered, 280 interactions
- "Weekend Special" - double points promotion, scheduled status

---

## How to Initialize Mock Data

### Option 1: API Call (Easiest)
```bash
curl http://localhost:3000/api/admin/init-mock-data
```

Or use your browser:
```
http://localhost:3000/api/admin/init-mock-data
```

### Option 2: From Code
```typescript
import { initializeAllMockData } from '@/lib/initMockData';

// Call once during app setup
await initializeAllMockData();
```

---

## Pages Updated to Use Firestore

### 1. **Admin Notifications** (`/admin/notifications`)
- ✅ Now fetches from `notifications` collection
- ✅ Saves new notifications to Firestore
- ✅ Shows real notification history
- **To replace mock data:** Just update the form submission to use real data sources

### 2. **Admin Push Notifications** (`/admin/push-notifications`)
- ✅ Now fetches from `campaigns` collection
- ✅ Saves new campaigns to Firestore
- ✅ Shows real campaign history
- **To replace mock data:** Update campaign creation logic

### 3. **Dashboard, Orders, Products, Events** (Already using real data)
- ✅ Connected to actual Firestore collections
- ✅ Show empty state if no data exists

---

## Firebase Functions (lib/firebase.ts)

All new functions are exported and ready to use:

```typescript
// Notifications
export async function getNotificationHistory(): NotificationHistory[]
export async function addNotification(notification: ...): Promise<string>

// Campaigns  
export async function getCampaigns(): Campaign[]
export async function addCampaign(campaign: ...): Promise<string>

// Initialization (in lib/initMockData.ts)
export async function initializeAllMockData(): Promise<void>
```

---

## Easy Data Replacement Guide

When you're ready to use real data instead of mock data:

### For Notifications Page
**Current:** Saves notifications to Firestore from admin form
**To add real data source:**
1. Modify `handleSendNotification()` to fetch from your real notification service
2. Update `loadNotificationHistory()` to filter by date range or source
3. Keep the Firestore calls - they'll store the real data

Example:
```typescript
// Before fetching from form, get from your real API
const realNotifications = await fetchFromYourService();
for (const notif of realNotifications) {
  await addNotification(notif);
}
```

### For Campaigns Page
**Current:** Saves campaigns to Firestore from admin form
**To add real data source:**
1. Replace campaign creation to fetch from your marketing platform
2. Update `loadCampaigns()` to include real campaign data
3. Store in Firestore for history

Example:
```typescript
// Fetch from your campaign service
const campaigns = await fetchCampaignsFromService();
for (const campaign of campaigns) {
  await addCampaign(campaign);
}
```

---

## Data Flow Architecture

```
Admin Pages → Form Input → addNotification/addCampaign() 
                              ↓
                        Firestore Collections
                              ↓
                    getNotificationHistory/getCampaigns()
                              ↓
                        Display in Admin UI

To use real data:
Real API/Service → addNotification/addCampaign() → Firestore → Admin UI
```

---

## Files Modified/Created

### Modified Files:
1. **lib/firebase.ts** - Added notification & campaign functions
2. **app/admin/notifications/page.tsx** - Now uses Firestore
3. **app/admin/push-notifications/page.tsx** - Now uses Firestore

### Created Files:
1. **lib/initMockData.ts** - Mock data initialization utility
2. **app/api/admin/init-mock-data/route.ts** - API endpoint to initialize

---

## Quick Start

1. **Initialize mock data** (first time only):
   ```bash
   curl http://localhost:3000/api/admin/init-mock-data
   ```

2. **Check Firestore Console:**
   - Go to Firebase Console
   - Select your project
   - Click "Firestore Database"
   - You'll see `notifications` and `campaigns` collections with data

3. **Visit admin pages:**
   - `/admin/notifications` - See notification history
   - `/admin/push-notifications` - See campaign history

4. **Replace mock data whenever ready:**
   - Update the form handlers to use your real data source
   - Firestore collection structure stays the same
   - Admin UI displays real data automatically

---

## Summary

✅ **All data now stored in Firestore tables**
✅ **Mock data automatically inserted on first API call**
✅ **Easy to replace with real data - just change the data source**
✅ **Consistent pattern across all admin pages**
✅ **Real-time updates in admin UI**

When you have real data ready, simply:
1. Replace the `addNotification`/`addCampaign` calls
2. Keep the Firestore structure and functions
3. Admin pages will automatically show real data
